<%= stylesheet_link_tag "ricerca_piatto.css"%>

<div id = "middle">
    
    <% @temp1 %>
    <% if params[:category] == "0" %>
        <% @temp1 = "Antipasti" %>
    <% elsif params[:category] == "1"%>
        <% @temp1 = "Primi" %>
    <% elsif params[:category] == "2"%>
        <% @temp1 = "Secondi" %>
    <% elsif params[:category] == "3"%>
        <% @temp1 = "Dolci" %>
    <%end%>

        <div id = "searches">
            <%if params[:category] != nil%>
                <div class = "search_infos"> Risultati ricerca "<%= @temp1 %>" : </div>
                <% (Dish.all).each do |dish| %>
                    <%if dish.category == params[:category].to_i %>
                        <% render dish%>
                        <div class = "dish_container">
                            <div class = "col_1">
                                <div class = "dish_pic"><img src="<%= url_for(dish.images[0])%>" alt="foto_piatto" width="200" height="200"></div>
                            </div>
                            <div class = "col_2">
                                <div class = "dish_name"><%= dish.name%></div>
                                <div class = "dish_rest">Ristorante : <%= dish.restaurant.name%></div>
                                <div class = "dish_price">Prezzo : <%= dish.price%>€</div>
                                <div class = "dish_desc">Descrizione : <%= dish.description%></div>
                                <div class = "btns">
                                    <div class = "div_show"><%= link_to "Mostra piatto", dish, :class => "btn btn-success" %></div>
                                    <div class = "div_review"><%= link_to "Lascia recensione", new_review_path, :class => "btn btn-warning" %></div>
                                </div>
                            </div>
                        </div> 
                    <%end%>

                <% end %>

            <%else%>
                <div class = "search_infos">Parametri ricercati: <%= params[:form_input].to_s %></div> 
                
                <%if params[:form_input].to_s != "" %>
                
                    <%if params[:sort] != nil%>
                        <% @get_dish = Dish.where("name LIKE ?","#{params[:form_input]}%" ).order(params[:sort]) %>
                    <%else%>
                        <% @get_dish = Dish.where("name LIKE ?","#{params[:form_input]}%" ) %>
                    <% end %>
                
                    <% render @get_dish%>
                
                    <% @get_dish.each do |dish|%>
                        <div class = "dish_container">
                            <div class = "col_1">
                                <div class = "dish_pic"><img src="<%= url_for(dish.images[0])%>" alt="foto_piatto" width="200" height="200"></div>                    </div>
                            <div class = "col_2">
                                <div class = "dish_name">Nome : <%= dish.name%></div>
                                <div class = "dish_rest">Ristorante : <%= dish.restaurant.name%></div>
                                <div class = "dish_price">Prezzo : <%= dish.price%>€</div>
                                <div class = "dish_desc">Descrizione : <%= dish.description%></div>
                                <div class = "btns">
                                    <div class = "div_show"><%= link_to "Mostra piatto", dish, :class => "btn btn-success" %></div>
                                    <div class = "div_review"><%= link_to "Lascia recensione", new_review_path, :class => "btn btn-warning" %></div>
                                </div>
                            </div>
                        </div>
                    <% end %>
                
                <%end%>

                <%#= link_to "Refresh", url_for(""), method: :get %>
                <%#= button_to search_search_dish_path, method: :get %>
                
            <%end%>
        </div>

        <div id = "search_opts">
            <%= render  "search/form" %>
        </div>
</div>